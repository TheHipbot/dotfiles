#!/usr/bin/env ruby

require 'fileutils'
require 'optparse'

# map of command line options
options = {}

options[:onlylinks] = false

# array of files/folders to symlink
Dir.chdir(File.dirname(__FILE__))
files = Dir['{*.symlink,.*.symlink}']

# parse command line options
OptionParser.new do |opts|
  opts.on("-p [ARG]", "--platform [ARG]") do |p|
    options[:platform] = p
  end

  opts.on("-l", "--links-only") do |p|
    options[:onlylinks] = true
  end

  opts.on("-f", "--full-monty") do |p|
    options[:fullmonty] = true
  end
end.parse!

if options[:fullmonty]
  # TODO install homebrew, update, pull pkgs from brew-pkgs file
  #      install rbenv, ruby, gems
end

# symlink files/folders
files.each do |f|
  basename = File.basename(f,File.extname(f))
  puts basename
  if File.exist?("#{ENV['HOME']}/#{basename}")
    puts "File #{basename} already exists in home folder, SKIPPING"
  else
    File.symlink("#{File.expand_path(File.dirname(__FILE__))}/#{f}", "#{ENV['HOME']}/#{basename}")
  end
end
